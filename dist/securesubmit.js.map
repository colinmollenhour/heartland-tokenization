{"version":3,"file":null,"sources":["../src/DOM.ts","../src/vars/cardTypes.ts","../src/Formatter/CardNumber.ts","../src/Formatter/Expiration.ts","../src/Validator/CardNumber.ts","../src/Validator/Cvv.ts","../src/Validator/Expiration.ts","../src/formatter/Expiration.ts","../src/Events.ts","../src/Card.ts","../src/vars/urls.ts","../src/Util.ts","../src/Ajax.ts","../src/Formatter/index.ts","../src/vars/defaults.ts","../src/vars/fields.ts","../src/Messages.ts","../src/Styles.ts","../src/Frames.ts","../src/HPS.ts","../src/Validator/index.ts","../src/index.ts"],"sourcesContent":["import {HPS} from \"./HPS\";\n\n/**\n * @namespace Heartland.DOM\n */\nexport class DOM {\n  /**\n   * Heartland.DOM.configureField\n   *\n   * Configures an input field in a single field iFrame.\n   *\n   * @param {Heartland.HPS} hps\n   */\n  public static configureField(hps: HPS) {\n    document.getElementById('heartland-field').setAttribute('name', hps.field);\n  }\n\n  /**\n   * Heartland.DOM.makeFrame\n   *\n   * Creates a single iFrame element with the appropriate defaults.\n   *\n   * @param {string} name\n   * @returns {HTMLIframeElement}\n   */\n  public static makeFrame(name: string) {\n    var frame = document.createElement('iframe');\n    frame.id = 'heartland-frame-' + name;\n    frame.name = name;\n    frame.style.border = '0';\n    frame.frameBorder = '0';\n    frame.scrolling = 'no';\n    return frame;\n  }\n\n  /**\n   * Heartland.DOM.addField\n   *\n   * Adds a DOM `input` node to `formParent` with type `fieldType`, name\n   * `fieldName`, and value `fieldValue`.\n   *\n   * @param {string} formParent\n   * @param {string} fieldType\n   * @param {string} fieldName\n   * @param {string} fieldValue\n   */\n  public static addField(formParent: string, fieldType: string, fieldName: string, fieldValue: string) {\n    var input = document.createElement('input');\n\n    input.setAttribute('type', fieldType);\n    input.setAttribute('name', fieldName);\n    input.setAttribute('value', fieldValue);\n\n    document.getElementById(formParent).appendChild(input);\n  }\n\n  /**\n   * Heartland.DOM.setStyle\n   *\n   * Sets an element's style attribute within a child iframe window.\n   *\n   * @param {string} elementid\n   * @param {string} htmlstyle\n   */\n  public static setStyle(elementid: string, htmlstyle: string) {\n    var el = document.getElementById(elementid);\n    if (el) {\n      el.setAttribute('style', DOM.encodeEntities(htmlstyle));\n    }\n  }\n\n  /**\n   * Heartland.DOM.appendStyle\n   *\n   * Appends an element's style attribute within a child iframe window.\n   *\n   * @param {string} elementid\n   * @param {String} htmlstyle\n   */\n  public static appendStyle(elementid: string, htmlstyle: string) {\n    var el = document.getElementById(elementid);\n    if (el) {\n      var currstyle = el.getAttribute('style');\n      var newstyle = (currstyle ? currstyle : '') + htmlstyle;\n      el.setAttribute('style', DOM.encodeEntities(newstyle));\n    }\n  }\n\n  /**\n   * Heartland.DOM.setText\n   *\n   * Sets an element's inner text within a child iframe window.\n   *\n   * @param {string} elementid\n   * @param {string} text\n   */\n  public static setText(elementid: string, text: string) {\n    var el = document.getElementById(elementid);\n    if (el) {\n      el.textContent = DOM.encodeEntities(text);\n    }\n  }\n\n  /**\n   * Heartland.DOM.setPlaceholder\n   *\n   * Sets an element's placeholder attribute within a child iframe window.\n   *\n   * @param {string} elementid\n   * @param {string} text\n   */\n  public static setPlaceholder(elementid: string, text: string) {\n    var el = document.getElementById(elementid);\n    if (el) {\n      if (text === '•••• •••• •••• ••••' || text === '••••' || text === '•••'\n        || text === '···· ···· ···· ····') {\n        el.setAttribute('placeholder', text);\n      } else {\n        el.setAttribute('placeholder', DOM.encodeEntities(text));\n      }\n    }\n  }\n\n  /**\n   * Heartland.DOM.resizeFrame\n   *\n   * Alerts a parent window to resize the iframe.\n   *\n   * @param {Heartland.HPS} hps\n   */\n  public static resizeFrame(hps: HPS) {\n    var docHeight = document.body.offsetHeight + 1; // off by one error\n    hps.Messages.post({ action: 'resize', height: docHeight }, 'parent');\n  }\n\n  /**\n   * Heartland.DOM.setFieldData\n   *\n   * Receives a field value from another frame prior to the tokenization process.\n   *\n   * @param {string} elementid\n   * @param {string} value\n   */\n  public static setFieldData(elementid: string, value: string) {\n    var el = document.getElementById(elementid);\n    if (!el && document.getElementById('heartland-field')) {\n      el = document.createElement('input');\n      el.setAttribute('id', DOM.encodeEntities(elementid));\n      el.setAttribute('type', 'hidden');\n      document.getElementById('heartland-field-wrapper').appendChild(el);\n    }\n\n    if (el) {\n      el.setAttribute('value', DOM.encodeEntities(value));\n    }\n  }\n\n  /**\n   * Heartland.DOM.getFieldData\n   *\n   * Retrieves a field value for another frame prior to the tokenization process.\n   *\n   * @param {Heartland.HPS} hps\n   * @param {string} elementid\n   */\n  public static getFieldData(hps: HPS, elementid: string) {\n    var el: HTMLInputElement = <HTMLInputElement>document.getElementById(elementid);\n    if (el) {\n      hps.Messages.post({ action: 'passData', value: el.value }, 'parent');\n    }\n  }\n\n  /**\n   * Heartland.DOM.addStylesheet\n   *\n   * Creates a `style` node in the DOM with the given `css`.\n   *\n   * @param {Heartland.HPS} hps\n   * @param {string} elementid\n   */\n  public static addStylesheet(css: string) {\n    var el = document.createElement('style');\n    var elements = document.getElementsByTagName('head');\n    el.type = 'text/css';\n    el.appendChild(document.createTextNode(css));\n    if (elements && elements[0]) {\n      elements[0].appendChild(el);\n    }\n  }\n\n  /**\n   * Heartland.DOM.json2css\n   *\n   * Converts a JSON node to text representing CSS.\n   *\n   * @param {string} json\n   * @returns {string}\n   */\n  public static json2css(json: Object): string {\n    var css = '';\n    var attributes: string[];\n    var children: Object[];\n    var i: number, j: number;\n    var key: any, value: any;\n\n    if (attributes = DOM.jsonAttributes(json)) {\n      var attributesLength = attributes.length;\n      for (i = 0; i < attributesLength; i++) {\n        key = attributes[i];\n        value = (<any>json)[key];\n        if (DOM.isArray(value)) {\n          var arrLength = value.length;\n          for (j = 0; j < arrLength; j++) {\n            css += key + ':' + value[j] + ';';\n          }\n        } else {\n          css += key + ':' + value + ';';\n        }\n      }\n    }\n\n    if (children = DOM.jsonChildren(json)) {\n      var childrenLength = children.length;\n      for (i = 0; i < childrenLength; i++) {\n        key = children[i];\n        value = (<any>json)[key];\n        css += key + '{' + DOM.json2css(value) + '}';\n      }\n    }\n\n    return css;\n  }\n\n  /**\n   * Heartland.DOM.setFocus\n   *\n   * Sets the focus on an iframe's field.\n   *\n   * @param {Heartland.HPS} hps\n   * @param {string} elementid\n   */\n  public static setFocus() {\n    var el = document.getElementById('heartland-field');\n    if (el) {\n      el.focus();\n    }\n  }\n\n  /***********\n   * Helpers *\n   ***********/\n\n  /**\n   * Escapes all potentially dangerous characters, so that the\n   * resulting string can be safely inserted into attribute or\n   * element text.\n   *\n   * @param value\n   * @returns {string} escaped text\n   */\n  private static encodeEntities(value: string) {\n    return value.\n      replace(/&/g, '&amp;').\n      replace(/[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g, function (v) {\n        var hi = v.charCodeAt(0);\n        var low = v.charCodeAt(1);\n        return '&#' + (((hi - 0xD800) * 0x400) + (low - 0xDC00) + 0x10000) + ';';\n      }).\n      replace(/([^\\#-~| |!])/g, function (v) {\n        return '&#' + v.charCodeAt(0) + ';';\n      }).\n      replace(/</g, '&lt;').\n      replace(/>/g, '&gt;');\n  }\n\n  private static isArray(obj: any): boolean {\n    return Object.prototype.toString.call(obj) === '[object Array]';\n  }\n\n  private static jsonAttributes(json: Object): string[] {\n    var set: string[] = [];\n    var i: string;\n    for (i in json) {\n      if (json.hasOwnProperty(i)\n        && (typeof (<any>json)[i] === 'string' || DOM.isArray((<any>json)[i]))) {\n        set.push(i);\n      }\n    }\n    return set;\n  }\n\n  private static jsonChildren(json: Object): Object[] {\n    var set: Object[] = [];\n    var i: string;\n    for (i in json) {\n      if (json.hasOwnProperty(i)\n        && (Object.prototype.toString.call((<any>json)[i]) === '[object Object]')) {\n        set.push(i);\n      }\n    }\n    return set;\n  }\n}\n","import {CardType} from \"../types/CardType\";\n\nexport var cardTypes: CardType[] = [\n  {\n    code: 'visa',\n    format: /(\\d{1,4})/g,\n    length: 16,\n    regex: /^4/\n  },\n  {\n    code: 'mastercard',\n    format: /(\\d{1,4})/g,\n    length: 16,\n    regex: /^(5[1-5]|2[2-7])/\n  },\n  {\n    code: 'amex',\n    format: /(\\d{1,4})(\\d{1,6})?(\\d{1,5})?/,\n    length: 15,\n    regex: /^3[47]/\n  },\n  {\n    code: 'diners',\n    format: /(\\d{1,4})(\\d{1,6})?(\\d{1,4})?/,\n    length: 14,\n    regex: /^3[0689]/\n  },\n  {\n    code: 'discover',\n    format: /(\\d{1,4})/g,\n    length: 16,\n    regex: /^6([045]|22)/\n  },\n  {\n    code: 'jcb',\n    format: /(\\d{1,4})/g,\n    length: 16,\n    regex: /^35/\n  }\n];\n","import {CardType} from \"../types/CardType\";\nimport {Formatter} from \"../types/Formatter\";\nimport {Card} from \"../Card\";\n\nexport class CardNumber implements Formatter {\n  format(number: string): string {\n    var type: CardType;\n    var matches: string[];\n\n    number = number.replace(/\\D/g, '');\n    type = Card.typeByNumber(number);\n\n    if (!type) { return number; }\n\n    matches = number.match(type.format);\n\n    if (!matches) { return number; }\n\n    if (!type.format.global) {\n      matches.shift();\n    }\n    return matches.join(' ').replace(/^\\s+|\\s+$/gm, '');\n  }\n}\n","import {Formatter} from \"../types/Formatter\";\n\nexport class Expiration implements Formatter {\n  format(exp: string, final = false): string {\n    var pat = /^\\D*(\\d{1,2})(\\D+)?(\\d{1,4})?/;\n    var groups = exp.match(pat);\n    var month: string;\n    var del: string;\n    var year: string;\n\n    if (!groups) {\n      return '';\n    }\n\n    month = groups[1] || '';\n    del = groups[2] || '';\n    year = groups[3] || '';\n\n    if (year.length > 0) {\n      del = ' / ';\n    } else if (month.length === 2 || del.length > 0) {\n      del = ' / ';\n    } else if (month.length === 1 && (month !== '0' && month !== '1')) {\n      del = ' / ';\n    }\n\n    if (month.length === 1 && del !== '') {\n      month = '0' + month;\n    }\n\n    if (final && year.length === 2) {\n      year = (new Date).getFullYear().toString().slice(0, 2) + year;\n    }\n\n    return month + del + year;\n  }\n}\n","import {CardType} from \"../types/CardType\";\nimport {Validator} from \"../types/Validator\";\nimport {Card} from \"../Card\";\n\nexport class CardNumber implements Validator {\n  validate(number: string): boolean {\n    var type: CardType;\n\n    if (!number) {\n      return false;\n    }\n\n    number = number.replace(/[-\\s]/g, '');\n    type = Card.typeByNumber(number);\n\n    if (!type) {\n      return false;\n    }\n    return Card.luhnCheck(number)\n      && number.length === type.length;\n  }\n}\n","import {Validator} from \"../types/Validator\";\n\nexport class Cvv implements Validator {\n  validate(cvv: string): boolean {\n    if (!cvv) {\n      return false;\n    }\n\n    cvv = cvv.replace(/^\\s+|\\s+$/g, '');\n\n    if (!/^\\d+$/.test(cvv)) {\n      return false;\n    }\n    return 3 <= cvv.length && cvv.length <= 4;\n  }\n}\n","import {Validator} from \"../types/Validator\";\n\nexport class Expiration implements Validator {\n  validate(exp: string): boolean {\n    var month: number;\n    var year: number;\n    var split: string[];\n    var m: string, y: string;\n\n    if (!exp) {\n      return false;\n    }\n\n    split = exp.split('/');\n    [m, y] = split;\n\n    if (!m || !y) {\n      return false;\n    }\n\n    m = m.replace(/^\\s+|\\s+$/g, '');\n    y = y.replace(/^\\s+|\\s+$/g, '');\n\n    if (!/^\\d+$/.test(m)) {\n      return false;\n    }\n    if (!/^\\d+$/.test(y)) {\n      return false;\n    }\n\n    if (y.length === 2) {\n      y = (new Date).getFullYear().toString().slice(0, 2) + y;\n    }\n\n    month = parseInt(m, 10);\n    year = parseInt(y, 10);\n\n    if (!(1 <= month && month <= 12)) {\n      return false;\n    }\n\n    // creates date as 1 day past end of\n    // expiration month since JS months\n    // are 0 indexed\n    return (new Date(year, month, 1)) > (new Date);\n  }\n}\n","import {Formatter} from \"../types/Formatter\";\n\nexport class Expiration implements Formatter {\n  format(exp: string, final = false): string {\n    var pat = /^\\D*(\\d{1,2})(\\D+)?(\\d{1,4})?/;\n    var groups = exp.match(pat);\n    var month: string;\n    var del: string;\n    var year: string;\n\n    if (!groups) {\n      return '';\n    }\n\n    month = groups[1] || '';\n    del = groups[2] || '';\n    year = groups[3] || '';\n\n    if (year.length > 0) {\n      del = ' / ';\n    } else if (month.length === 2 || del.length > 0) {\n      del = ' / ';\n    } else if (month.length === 1 && (month !== '0' && month !== '1')) {\n      del = ' / ';\n    }\n\n    if (month.length === 1 && del !== '') {\n      month = '0' + month;\n    }\n\n    if (final && year.length === 2) {\n      year = (new Date).getFullYear().toString().slice(0, 2) + year;\n    }\n\n    return month + del + year;\n  }\n}\n","import {DOM} from \"./DOM\";\nimport {HPS} from \"./HPS\";\nimport {CardData} from \"./types/CardData\";\nimport {TokenizationResponse} from \"./types/TokenizationResponse\";\nimport {Expiration as ExpirationFormatter} from \"./formatter/Expiration\";\n\nclass Ev {\n  public static listen(node: EventTarget, eventName: string, callback: EventListener) {\n    if (document.addEventListener) {\n      node.addEventListener(eventName, callback, false);\n    } else {\n      if (node === document) {\n        (<any>document.documentElement).attachEvent('onpropertychange', function (e: Event) {\n          if ((<any>e).propertyName === eventName) {\n            callback(e);\n          }\n        });\n      } else {\n        (<any>node).attachEvent('on' + eventName, callback);\n      }\n    }\n  }\n  public static trigger(node: EventTarget, eventName: string) {\n    if (document.createEvent) {\n      var event = document.createEvent('Event');\n      event.initEvent(eventName, true, true);\n      node.dispatchEvent(event);\n    } else {\n      (<any>document.documentElement)[eventName]++;\n    }\n  }\n  public static ignore(eventName: string, callback: EventListener) {\n    if (document.removeEventListener) {\n      document.removeEventListener(eventName, callback, false);\n    } else {\n      (<any>document.documentElement).detachEvent('onpropertychange', function (e: Event) {\n        if ((<any>e).propertyName === eventName) {\n          callback(e);\n        }\n      });\n    }\n  }\n}\n\n/**\n * @namespace Heartland.Events\n */\nexport class Events {\n  /**\n   * Heartland.Events.addHandler\n   *\n   * Adds an `event` handler for a given `target` element.\n   *\n   * @param {string | EventTarget} target\n   * @param {string} event\n   * @param {EventListener} callback\n   */\n  public static addHandler(target: string | EventTarget, event: string, callback: EventListener) {\n    var node: EventTarget;\n    if (typeof target === 'string') {\n      node = document.getElementById(<string>target);\n    } else {\n      node = target;\n    }\n\n    if (document.addEventListener) {\n      node.addEventListener(event, callback, false);\n    } else {\n      Ev.listen(node, event, callback);\n    }\n  }\n\n  /**\n   * Heartland.Events.removeHandler\n   *\n   * Removes an `event` handler for a given `target` element.\n   *\n   * @param {string | EventTarget} target\n   * @param {string} event\n   * @param {EventListener} callback\n   */\n  public static removeHandler(target: string | EventTarget, event: string, callback: EventListener) {\n    var node: EventTarget;\n    if (typeof target === 'string') {\n      node = document.getElementById(<string>target);\n    } else {\n      node = target;\n    }\n\n    if (document.removeEventListener) {\n      node.removeEventListener(event, callback, false);\n    } else {\n      Ev.ignore(event, callback);\n    }\n  }\n\n  /**\n   * Heartland.Events.trigger\n   *\n   * Fires off an `event` for a given `target` element.\n   *\n   * @param {string} name\n   * @param {any} target\n   * @param {any} data [optional]\n   */\n  public static trigger(name: string, target: any, data?: any, bubble = false) {\n    var event: any;\n\n    if (document.createEvent) {\n      event = document.createEvent('Event');\n      event.initEvent(name, true, true);\n      target.dispatchEvent(event);\n    } else {\n      Ev.trigger(target, name);\n    }\n  }\n\n  /**\n   * Heartland.Events.frameHandleWith\n   *\n   * Wraps `hps` state in a closure to provide a `Heartland.Messages.receive`\n   * callback handler for iFrame children.\n   *\n   * @param {Heartland.HPS} hps\n   */\n  public static frameHandleWith(hps: HPS): (m: any) => void {\n    return function (data) {\n      switch (data.action) {\n        case 'tokenize':\n          if (data.accumulateData) {\n            hps.Messages.post(\n              {\n                action: 'accumulateData'\n              },\n              'parent'\n            );\n            var el = document.createElement('input');\n            el.id = 'publicKey';\n            el.type = 'hidden';\n            el.value = data.message;\n            document\n              .getElementById('heartland-field-wrapper')\n              .appendChild(el);\n          } else {\n            Events.tokenizeIframe(hps, data.message);\n          }\n          break;\n        case 'setStyle':\n          DOM.setStyle(data.id, data.style);\n          DOM.resizeFrame(hps);\n          break;\n        case 'appendStyle':\n          DOM.appendStyle(data.id, data.style);\n          DOM.resizeFrame(hps);\n          break;\n        case 'setText':\n          DOM.setText(data.id, data.text);\n          DOM.resizeFrame(hps);\n          break;\n        case 'setPlaceholder':\n          DOM.setPlaceholder(data.id, data.text);\n          break;\n        case 'setFieldData':\n          DOM.setFieldData(data.id, data.value);\n          if (document.getElementById('heartland-field') &&\n            document.getElementById('cardCvv') &&\n            document.getElementById('cardExpiration')) {\n            var pkey = document.getElementById('publicKey');\n            Events.tokenizeIframe(hps, (pkey ? pkey.getAttribute('value') : ''));\n          }\n          break;\n        case 'getFieldData':\n          DOM.getFieldData(hps, data.id);\n          break;\n        case 'addStylesheet':\n          DOM.addStylesheet(data.data);\n          DOM.resizeFrame(hps);\n          break;\n        case 'setFocus':\n          DOM.setFocus();\n          break;\n      }\n    };\n  }\n\n  /**\n   * tokenizeIframe\n   *\n   * Tokenizes card data. Used in iframe integrations to tokenize on Heartland's\n   * servers.\n   *\n   * @param {Heartland.HPS} hps\n   * @param {string} publicKey\n   */\n  public static tokenizeIframe(hps: HPS, publicKey: string) {\n    var card: CardData = {};\n    var numberElement = <HTMLInputElement>(document.getElementById('heartland-field')\n      || document.getElementById('heartland-card-number'));\n    var cvvElement = <HTMLInputElement>(document.getElementById('cardCvv')\n      || document.getElementById('heartland-cvv'));\n    var expElement = document.getElementById('cardExpiration');\n    var tokenResponse = (action: string) => {\n      return (response: TokenizationResponse) => {\n        hps.Messages.post({ action: action, response: response }, 'parent');\n        if (cvvElement) {\n          if (cvvElement.parentNode) {\n            cvvElement.parentNode.removeChild(cvvElement);\n          } else {\n            cvvElement.remove();\n          }\n        }\n        if (expElement) {\n          if (expElement.parentNode) {\n            expElement.parentNode.removeChild(expElement);\n          } else {\n            expElement.remove();\n          }\n        }\n      };\n    };\n\n    card.number = numberElement ? numberElement.value : '';\n    card.cvv = cvvElement ? cvvElement.value : '';\n    card.exp = expElement;\n\n    if (card.exp) {\n      var formatter = new ExpirationFormatter();\n      var cardExpSplit = formatter.format((<HTMLInputElement>card.exp).value, true).split('/');\n      card.expMonth = cardExpSplit[0];\n      card.expYear = cardExpSplit[1];\n      card.exp = undefined;\n    } else {\n      card.expMonth = (<HTMLInputElement>document.getElementById('heartland-expiration-month')).value;\n      card.expYear = (<HTMLInputElement>document.getElementById('heartland-expiration-year')).value;\n    }\n\n    hps.tokenize({\n      cardCvv: card.cvv ? card.cvv : '',\n      cardExpMonth: card.expMonth ? card.expMonth : '',\n      cardExpYear: card.expYear ? card.expYear : '',\n      cardNumber: card.number ? card.number : '',\n      error: tokenResponse('onTokenError'),\n      publicKey: publicKey ? publicKey : '',\n      success: tokenResponse('onTokenSuccess'),\n      type: 'pan'\n    });\n  }\n}\n","import {CardType} from \"./types/CardType\";\nimport {cardTypes} from \"./vars/cardTypes\";\nimport {CardNumber as CardNumberFormatter} from \"./Formatter/CardNumber\";\nimport {Expiration as ExpirationFormatter} from \"./Formatter/Expiration\";\nimport {CardNumber as CardNumberValidator} from \"./Validator/CardNumber\";\nimport {Cvv as CvvValidator} from \"./Validator/Cvv\";\nimport {Expiration as ExpirationValidator} from \"./Validator/Expiration\";\n\nimport {Events} from \"./Events\";\n\n/**\n * @namespace Heartland.Card\n */\nexport class Card {\n  /**\n   * Heartland.Card.typeByNumber\n   *\n   * Helper function to grab the CardType for a given card number.\n   *\n   * @param {string} number - The card number\n   * @returns {Heartland.CardType}\n   */\n  public static typeByNumber(number: string): CardType {\n    var cardType: CardType;\n    var i: any;\n\n    if (!number) { return null; }\n    if (number.replace(/^\\s+|\\s+$/gm, '').length < 4) { return null; }\n\n    for (i in cardTypes) {\n      cardType = cardTypes[i];\n      if (cardType && cardType.regex && cardType.regex.test(number)) {\n        break;\n      }\n    }\n\n    return cardType;\n  }\n\n  /**\n   * Heartland.Card.typeByTrack\n   *\n   * @param {string} data - track data\n   * @param {boolean} isEncrypted - (default: false)\n   * @param {string} trackNumber\n   *\n   * @returns CardType\n   */\n  public static typeByTrack(data: string, isEncrypted = false, trackNumber?: string) {\n    var number: string;\n\n    if (isEncrypted && trackNumber && trackNumber === '02') {\n      number = data.split('=')[0];\n    } else {\n      var temp = data.split('%');\n      if (temp[1]) {\n        temp = temp[1].split('^');\n        if (temp[0]) {\n          number = temp[0].toString().substr(1);\n        }\n      }\n    }\n\n    return Card.typeByNumber(number);\n  }\n\n  /**\n   * Heartland.Card.luhnCheck\n   *\n   * Runs a mod 10 check on a given card number.\n   *\n   * @param {string} number - The card number\n   * @returns {boolean}\n   */\n  public static luhnCheck(number: string): boolean {\n    var odd = true;\n    var sum = 0;\n    var digits: string[];\n    var i = 0;\n    var length = 0;\n    var digit: number;\n\n    if (!number) {\n      return false;\n    }\n\n    digits = number.split('').reverse();\n    length = digits.length;\n\n    for (i; i < length; i++) {\n      digit = parseInt(digits[i], 10);\n      if (odd = !odd) {\n        digit *= 2;\n      }\n      if (digit > 9) {\n        digit -= 9;\n      }\n      sum += digit;\n    }\n\n    return sum % 10 === 0;\n  }\n\n  /**\n   * Heartland.Card.addType\n   *\n   * Adds a class to the target element with the card type\n   * inferred from the target's current value.\n   *\n   * @param {Event} e\n   */\n  public static addType(e: Event) {\n    var target = <HTMLInputElement>(e.currentTarget ? e.currentTarget : e.srcElement);\n    var type = Card.typeByNumber(target.value);\n    var classList = target.className.split(' ');\n    var length = classList.length;\n    var i = 0;\n    var c = '';\n\n    for (i; i < length; i++) {\n      c = classList[i];\n      if (c && c.indexOf('card-type-') !== -1) {\n        delete classList[i];\n      }\n    }\n\n    if (type) {\n      classList.push('card-type-' + type.code);\n    }\n\n    target.className = classList.join(' ').replace(/^\\s+|\\s+$/gm, '');\n  }\n\n  /**\n   * Heartland.Card.formatNumber\n   *\n   * Formats a target element's value based on the\n   * inferred card type's formatting regex.\n   *\n   * @param {Event} e\n   */\n  public static formatNumber(e: Event) {\n    var target = <HTMLInputElement>(e.currentTarget ? e.currentTarget : e.srcElement);\n    var value = target.value;\n\n    if (value.length === 0) { return; }\n\n    var formatted = (new CardNumberFormatter).format(value);\n    target.value = formatted;\n\n    if (!target.setSelectionRange) { return; }\n\n    var cursor = target.selectionStart;\n\n    // copy and paste, space inserted on formatter\n    if (value.length < formatted.length) {\n      cursor += formatted.length - value.length;\n    }\n\n    // check if before new inserted digit is a space\n    if (value.charAt(cursor) === ' ' &&\n      formatted.charAt(cursor - 1) === ' ') {\n      cursor += 1;\n    }\n\n    target.setSelectionRange(cursor, cursor);\n  }\n\n  /**\n   * Heartland.Card.formatExpiration\n   *\n   * Formats a target element's value.\n   *\n   * @param {KeyboardEvent} e\n   */\n  public static formatExpiration(e: KeyboardEvent) {\n    var target = <HTMLInputElement>(e.currentTarget ? e.currentTarget : e.srcElement);\n    var value = target.value;\n    // allow: delete, backspace\n    if ([46, 8].indexOf(e.keyCode) !== -1 ||\n      // allow: home, end, left, right\n      (e.keyCode >= 35 && e.keyCode <= 39)) {\n      return;\n    }\n    value = (new ExpirationFormatter).format(value, e.type === 'blur');\n    target.value = value;\n  }\n\n  /**\n   * Heartland.Card.restrictLength\n   *\n   * Restricts input in a target element to a\n   * certain length data.\n   *\n   * @param {number} length\n   *\n   * @returns {(e: KeyboardEvent) => ()}\n   */\n  public static restrictLength(length: number) {\n    return function (e: KeyboardEvent) {\n      var target = <HTMLInputElement>(e.currentTarget ? e.currentTarget : e.srcElement);\n      var value = target.value;\n      // allow: backspace, delete, tab, escape and enter\n      if ([46, 8, 9, 27, 13, 110].indexOf(e.keyCode) !== -1 ||\n        // allow: Ctrl+A\n        (e.keyCode === 65 && e.ctrlKey === true) ||\n        // allow: home, end, left, right\n        (e.keyCode >= 35 && e.keyCode <= 39)) {\n        // let it happen, don't do anything\n        return;\n      }\n      if (value.length >= length) {\n        e.preventDefault ? e.preventDefault() : (e.returnValue = false);\n      }\n    };\n  }\n\n  /**\n   * Heartland.Card.restrictNumeric\n   *\n   * Restricts input in a target element to only\n   * numeric data.\n   *\n   * @param {KeyboardEvent} e\n   */\n  public static restrictNumeric(e: KeyboardEvent) {\n    // allow: backspace, delete, tab, escape and enter\n    if ([46, 8, 9, 27, 13, 110].indexOf(e.keyCode) !== -1 ||\n      // allow: Ctrl+A\n      (e.keyCode === 65 && e.ctrlKey === true) ||\n      // allow: home, end, left, right\n      (e.keyCode >= 35 && e.keyCode <= 39)) {\n      // let it happen, don't do anything\n      return;\n    }\n    // ensure that it is a number and stop the keypress\n    if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {\n      e.preventDefault ? e.preventDefault() : (e.returnValue = false);\n    }\n  }\n\n  /**\n   * Heartland.Card.deleteProperly\n   *\n   * Places cursor on the correct position to\n   * let the browser delete the digit instead\n   * of the space.\n   *\n   * @param {KeyboardEvent} e\n   */\n  public static deleteProperly(e: KeyboardEvent) {\n    var target = <HTMLInputElement>(e.currentTarget ? e.currentTarget : e.srcElement);\n    var value = target.value;\n\n    if (!target.setSelectionRange) { return; }\n\n    var cursor = target.selectionStart;\n\n    // allow: delete, backspace\n    if ([46, 8].indexOf(e.keyCode) !== -1 &&\n      // if space to be deleted\n      (value.charAt(cursor - 1) === ' ')) {\n      // placing cursor before space to delete digit instead\n      target.setSelectionRange(cursor - 1, cursor - 1);\n    }\n  }\n\n  /**\n   * Heartland.Card.validateNumber\n   *\n   * Validates a target element's value based on the\n   * inferred card type's validation regex. Adds a\n   * class to the target element to note `valid` or\n   * `invalid`.\n   *\n   * @param {Event} e\n   */\n  public static validateNumber(e: Event) {\n    var target = <HTMLInputElement>(e.currentTarget ? e.currentTarget : e.srcElement);\n    var value = target.value;\n    var classList = target.className.split(' ');\n    var length = classList.length;\n    var c = '';\n\n    for (var i = 0; i < length; i++) {\n      c = classList[i];\n      if (c.indexOf('valid') !== -1) {\n        delete classList[i];\n      }\n    }\n\n    if ((new CardNumberValidator).validate(value)) {\n      classList.push('valid');\n    } else {\n      classList.push('invalid');\n    }\n\n    target.className = classList.join(' ').replace(/^\\s+|\\s+$/gm, '');\n  }\n\n  /**\n   * Heartland.Card.validateCvv\n   *\n   * Validates a target element's value based on the\n   * possible CVV lengths. Adds a class to the target\n   * element to note `valid` or `invalid`.\n   *\n   * @param {Event} e\n   */\n  public static validateCvv(e: Event) {\n    var target = <HTMLInputElement>(e.currentTarget ? e.currentTarget : e.srcElement);\n    var value = target.value;\n    var classList = target.className.split(' ');\n    var length = classList.length;\n    var c = '';\n\n    for (var i = 0; i < length; i++) {\n      c = classList[i];\n      if (c.indexOf('valid') !== -1) {\n        delete classList[i];\n      }\n    }\n\n    if ((new CvvValidator).validate(value)) {\n      classList.push('valid');\n    } else {\n      classList.push('invalid');\n    }\n\n    target.className = classList.join(' ').replace(/^\\s+|\\s+$/gm, '');\n  }\n\n  /**\n   * Heartland.Card.validateExpiration\n   *\n   * Validates a target element's value based on the\n   * current date. Adds a class to the target element\n   * to note `valid` or `invalid`.\n   *\n   * @param {Event} e\n   */\n  public static validateExpiration(e: Event) {\n    var target = <HTMLInputElement>(e.currentTarget ? e.currentTarget : e.srcElement);\n    var value = target.value;\n    var classList = target.className.split(' ');\n    var length = classList.length;\n    var c = '';\n\n    for (var i = 0; i < length; i++) {\n      c = classList[i];\n      if (c.indexOf('valid') !== -1) {\n        delete classList[i];\n      }\n    }\n\n    if ((new ExpirationValidator).validate(value)) {\n      classList.push('valid');\n    } else {\n      classList.push('invalid');\n    }\n\n    target.className = classList.join(' ').replace(/^\\s+|\\s+$/gm, '');\n  }\n\n  /**\n   * Heartland.Card.attachNumberEvents\n   *\n   * @param {string} selector\n   */\n  public static attachNumberEvents(selector: string) {\n    Events.addHandler(document.querySelector(selector), 'keydown', Card.restrictNumeric);\n    Events.addHandler(document.querySelector(selector), 'keydown', Card.restrictLength(19));\n    Events.addHandler(document.querySelector(selector), 'keydown', Card.deleteProperly);\n    Events.addHandler(document.querySelector(selector), 'input', Card.formatNumber);\n    Events.addHandler(document.querySelector(selector), 'input', Card.validateNumber);\n    Events.addHandler(document.querySelector(selector), 'input', Card.addType);\n  }\n\n  /**\n   * Heartland.Card.attachExpirationEvents\n   *\n   * @param {string} selector\n   */\n  public static attachExpirationEvents(selector: string) {\n    Events.addHandler(document.querySelector(selector), 'keydown', Card.restrictNumeric);\n    Events.addHandler(document.querySelector(selector), 'keydown', Card.restrictLength(9));\n    Events.addHandler(document.querySelector(selector), 'keyup', Card.formatExpiration);\n    Events.addHandler(document.querySelector(selector), 'blur', Card.formatExpiration);\n    Events.addHandler(document.querySelector(selector), 'input', Card.validateExpiration);\n    Events.addHandler(document.querySelector(selector), 'blur', Card.validateExpiration);\n  }\n\n  /**\n   * Heartland.Card.attachCvvEvents\n   *\n   * @param {string} selector\n   */\n  public static attachCvvEvents(selector: string) {\n    Events.addHandler(document.querySelector(selector), 'keydown', Card.restrictNumeric);\n    Events.addHandler(document.querySelector(selector), 'keydown', Card.restrictLength(4));\n    Events.addHandler(document.querySelector(selector), 'input', Card.validateCvv);\n  }\n}\n\nif (!Array.prototype.indexOf) {\n  Array.prototype.indexOf = function (obj, start) {\n    for (var i = (start || 0), j = Card.length; i < j; i++) {\n      if (Card[i] === obj) { return i; }\n    }\n    return -1;\n  };\n}\n","export var urls = {\n  CERT: 'https://cert.api2.heartlandportico.com/Hps.Exchange.PosGateway.Hpf.v1/api/token',\n  PROD: 'https://api.heartlandportico.com/SecureSubmit.v1/api/token',\n  iframeCERT: 'https://hps.github.io/token/2.1/',\n  iframePROD: 'https://api.heartlandportico.com/SecureSubmit.v1/token/2.1/'\n};\n","import {Ajax} from \"./Ajax\";\nimport {Card} from \"./Card\";\nimport {DOM} from \"./DOM\";\nimport {Events} from \"./Events\";\nimport {CardData} from \"./types/CardData\";\nimport {CardType} from \"./types/CardType\";\nimport {Options} from \"./types/Options\";\nimport {TokenizationResponse} from \"./types/TokenizationResponse\";\nimport {urls} from \"./vars/urls\";\n\n/**\n * @namespace Heartland.Util\n */\nexport class Util {\n  /**\n   * Heartland.Util.getCardType\n   *\n   * Parses a credit card number to obtain the card type/brand.\n   *\n   * @param {string} tokenizationType\n   * @param {Heartland.Options} options\n   */\n  public static getCardType(tokenizationType: string, options: Options) {\n    var cardType: CardType;\n    var data = '';\n    var type = 'unknown';\n\n    switch (tokenizationType) {\n      case 'swipe':\n        data = options.track;\n        cardType = Card.typeByTrack(data);\n        break;\n      case 'encrypted':\n        data = options.track;\n        cardType = Card.typeByTrack(data, true, options.trackNumber);\n        break;\n      default:\n        data = options.cardNumber;\n        cardType = Card.typeByNumber(data);\n        break;\n    }\n\n    if (cardType) {\n      type = cardType.code;\n    }\n\n    return type;\n  }\n\n  /**\n   * Heartland.Util.applyOptions\n   *\n   * Creates a single object by merging a `source` (default) and `properties`\n   * obtained elsewhere, e.g. a function argument in `HPS`. Any properties in\n   * `properties` will overwrite matching properties in `source`.\n   *\n   * @param {Heartland.Options} source\n   * @param {Heartland.Options} properties\n   * @returns {Heartland.Options}\n   */\n  public static applyOptions(source: Options, properties: Options) {\n    var property: string;\n    var destination: Options = {};\n\n    if (!source) {\n      source = {};\n    }\n\n    for (property in source) {\n      if (source.hasOwnProperty(property)) {\n        (<any>destination)[property] = (<any>source)[property];\n      }\n    }\n\n    for (property in properties) {\n      if (properties.hasOwnProperty(property)) {\n        (<any>destination)[property] = (<any>properties)[property];\n      }\n    }\n\n    return destination;\n  }\n\n  /**\n   * Heartland.Util.throwError\n   *\n   * Allows a merchant-defined error handler to be used in cases where the\n   * tokenization process fails. If not provided, we throw the message as a\n   * JS runtime error.\n   *\n   * @param {Heartland.Options} options\n   * @param {string | Heartland.TokenizationResponse} errorMessage\n   */\n  public static throwError(options: Options, errorMessage: string | TokenizationResponse) {\n    if (typeof (options.error) === 'function') {\n      options.error(errorMessage);\n    } else {\n      throw errorMessage;\n    }\n  }\n\n  /**\n   * Heartland.Util.getItemByPropertyValue\n   *\n   * Enumerates over a `collection` to retreive an item whose `property` is\n   * a given `value`.\n   *\n   * @param {any} collection\n   * @param {string} property\n   * @param {any} value\n   * @returns {any}\n   */\n  public static getItemByPropertyValue(collection: any, property: string, value: any) {\n    var length = collection.length;\n    var i = 0;\n\n    for (i; i < length; i++) {\n      if (collection[i][property] === value) {\n        return collection[i];\n      }\n    }\n  }\n\n  /**\n   * Heartland.Util.getParams\n   *\n   * Builds param list for a particular `type` from expected properties in\n   * `data`.\n   *\n   * @param {string} type - The tokenization type\n   * @param {Heartland.Options} data\n   * @returns {string}\n   */\n  public static getParams(type: string, data: Options) {\n    var params: Array<string> = [];\n    switch (type) {\n      case 'pan':\n        params.push(\n          'token_type=supt',\n          'object=token',\n          '_method=post',\n          'api_key=' + data.publicKey.replace(/^\\s+|\\s+$/g, ''),\n          'card%5Bnumber%5D=' + data.cardNumber.replace(/\\s/g, ''),\n          'card%5Bexp_month%5D=' + data.cardExpMonth.replace(/^\\s+|\\s+$/g, ''),\n          'card%5Bexp_year%5D=' + data.cardExpYear.replace(/^\\s+|\\s+$/g, ''),\n          'card%5Bcvc%5D=' + data.cardCvv.replace(/^\\s+|\\s+$/g, '')\n        );\n        break;\n      case 'swipe':\n        params.push(\n          'token_type=supt',\n          'object=token',\n          '_method=post',\n          'api_key=' + data.publicKey.replace(/^\\s+|\\s+$/g, ''),\n          'card%5Btrack_method%5D=swipe',\n          'card%5Btrack%5D=' + encodeURIComponent(data.track.replace(/^\\s+|\\s+$/g, ''))\n        );\n        break;\n      case 'encrypted':\n        params.push(\n          'token_type=supt',\n          'object=token',\n          '_method=post',\n          'api_key=' + data.publicKey.replace(/^\\s+|\\s+$/g, ''),\n          'encryptedcard%5Btrack_method%5D=swipe',\n          'encryptedcard%5Btrack%5D=' + encodeURIComponent(data.track.replace(/^\\s+|\\s+$/g, '')),\n          'encryptedcard%5Btrack_number%5D=' + encodeURIComponent(data.trackNumber.replace(/^\\s+|\\s+$/g, '')),\n          'encryptedcard%5Bktb%5D=' + encodeURIComponent(data.ktb.replace(/^\\s+|\\s+$/g, '')),\n          'encryptedcard%5Bpin_block%5D=' + encodeURIComponent(data.pinBlock.replace(/^\\s+|\\s+$/g, ''))\n        );\n        break;\n      default:\n        Util.throwError(data, 'unknown params type');\n        break;\n    }\n    return '?' + params.join('&');\n  }\n\n  /**\n   * Heartland.Util.getUrlByEnv\n   *\n   * Selects the appropriate tokenization service URL for the\n   * active `publicKey`.\n   *\n   * @param {Heartland.Options} options\n   * @returns {string}\n   */\n  public static getUrlByEnv(options: Options) {\n    options.env = options.publicKey.split('_')[1];\n\n    if (options.env === 'cert') {\n      options.gatewayUrl = urls.CERT;\n    } else {\n      options.gatewayUrl = urls.PROD;\n    }\n\n    return options;\n  }\n\n  /**\n   * Heartland.Util.addFormHandler\n   *\n   * Creates and adds an event handler function for the submission for a given\n   * form (`options.form_id`).\n   *\n   * @param {Heartland.Options} options\n   * @listens submit\n   */\n  public static addFormHandler(options: Options) {\n    var payment_form = document.getElementById(options.formId);\n\n    var code = function (e: Event) {\n      if (e.preventDefault) {\n        e.preventDefault();\n      } else if (window.event) /* for ie */ {\n        window.event.returnValue = false;\n      }\n\n      var fields = Util.getFields(options.formId);\n      var cardType = Util.getCardType(fields.number, 'pan');\n\n      options.cardNumber = fields.number;\n      options.cardExpMonth = fields.expMonth;\n      options.cardExpYear = fields.expYear;\n      options.cardCvv = fields.cvv;\n      options.cardType = cardType;\n\n      Ajax.call('pan', options);\n    };\n\n    Events.addHandler(payment_form, 'submit', code);\n    DOM.addField(options.formId, 'hidden', 'publicKey', options.publicKey);\n  }\n\n  /**\n   * Heartland.Util.getFields\n   *\n   * Extracts card information from the fields with names `card_number`,\n   * `card_expiration_month`, `card_expiration_year`, and `card_cvc` and\n   * expects them to be present as children of `formParent`.\n   *\n   * @param {string} formParent\n   * @returns {Heartland.CardData}\n   */\n  public static getFields(formParent: string): CardData {\n    var form = document.getElementById(formParent);\n    var fields: CardData = {};\n    var i: number, element: HTMLInputElement;\n    var length = form.childElementCount;\n\n    for (i = 0; i < length; i++) {\n      element = <HTMLInputElement>form.children[i];\n      if (element.id === 'card_number') {\n        fields.number = element.value;\n      } else if (element.id === 'card_expiration_month') {\n        fields.expMonth = element.value;\n      } else if (element.id === 'card_expiration_year') {\n        fields.expYear = element.value;\n      } else if (element.id === 'card_cvc') {\n        fields.cvv = element.value;\n      }\n    }\n\n    return fields;\n  }\n}\n","import {DOM} from \"./DOM.ts\";\nimport {Util} from \"./Util.ts\";\nimport {Options} from \"./types/Options\";\nimport {TokenizationResponse} from \"./types/TokenizationResponse\";\n\n/**\n * @namespace Heartland.Ajax\n */\nexport class Ajax {\n  /**\n   * Heartland.Ajax.call\n   *\n   * Sets up a request to be passed to `Heartland.Ajax.jsonp`. On successful tokenization,\n   * `options.success` will be called with the tokenization data as the only\n   * argument passed.\n   *\n   * @param {string} type\n   * @param {Heartland.Options} options\n   */\n  public static call(type: string, options: Options) {\n    var cardType = Util.getCardType(type, options);\n    var params = Util.getParams(type, options);\n\n    Ajax.jsonp(options.gatewayUrl + params, function (data) {\n      if (data.error) {\n        Util.throwError(options, data);\n      } else {\n        var card = data.card || data.encryptedcard;\n        var lastfour = card.number.slice(-4);\n\n        data.last_four = lastfour;\n        data.card_type = cardType;\n        data.exp_month = options.cardExpMonth;\n        data.exp_year = options.cardExpYear;\n\n        if (options.formId && options.formId.length > 0) {\n          DOM.addField(options.formId, 'hidden', 'token_value', data.token_value);\n          DOM.addField(options.formId, 'hidden', 'last_four', lastfour);\n          DOM.addField(options.formId, 'hidden', 'card_exp_year', options.cardExpYear);\n          DOM.addField(options.formId, 'hidden', 'card_exp_month', options.cardExpMonth);\n          DOM.addField(options.formId, 'hidden', 'card_type', cardType);\n        }\n\n        options.success(data);\n      }\n    });\n  }\n\n  /**\n   * Heartland.Ajax.jsonp\n   *\n   * Creates a new DOM node containing a created JSONP callback handler for an\n   * impending Ajax JSONP request. Removes need for `XMLHttpRequest`.\n   *\n   * @param {string} url\n   * @param {function} callback\n   */\n  private static jsonp(url: string, callback: (data: TokenizationResponse) => void) {\n    var script = document.createElement('script');\n    var callbackName = 'jsonp_callback_' + Math.round(100000 * Math.random());\n    (<any>window)[callbackName] = function (data: TokenizationResponse): void {\n      (<any>window)[callbackName] = undefined;\n      document.body.removeChild(script);\n      callback(data);\n    };\n\n    script.src = url + (url.indexOf('?') >= 0 ? '&' : '?') + 'callback=' + callbackName;\n    document.body.appendChild(script);\n  }\n}\n","import {CardNumber} from \"./CardNumber\";\nimport {Expiration} from \"./Expiration\";\n\nexport default {\n    CardNumber: CardNumber,\n    Expiration: Expiration\n}\n","import {Options} from \"../types/Options\";\n\nexport var defaults: Options = {\n  _method: 'post',\n  buttonTarget: '',\n  cardCvv: '',\n  cardExpMonth: '',\n  cardExpYear: '',\n  cardNumber: '',\n  cardType: '',\n  env: 'prod',\n  error: null,\n  fields: {},\n  formId: '',\n  gatewayUrl: '',\n  iframeTarget: '',\n  ktb: '',\n  object: 'token',\n  onEvent: null,\n  onTokenError: null,\n  onTokenSuccess: null,\n  pinBlock: '',\n  publicKey: '',\n  success: null,\n  targetType: '',\n  tokenType: 'supt',\n  track: '',\n  trackNumber: '',\n  type: 'pan',\n  useDefaultStyles: true\n};\n","export var fields = [\n  'cardNumber',\n  'cardCvv',\n  'cardExpiration',\n  'submit'\n];\n","import {Events} from \"./Events\";\nimport {HPS} from \"./HPS\";\n\n/**\n * Heartland.Messages\n *\n * Initializes a new object for wrapping `window.postMessage` and a fallback\n * method for legacy browsers.\n */\nexport class Messages {\n  hps: HPS;\n  intervalId: number;\n  lastHash: string;\n  pushIntervalStarted: boolean;\n  private callback: (m: any) => any;\n\n  /**\n   * Heartland.Messages (constructor)\n   *\n   * @constructor\n   * @param {Heartland.HPS} hps\n   * @returns {Heartland.Messages}\n   */\n  constructor(hps: HPS) {\n    this.hps = hps;\n    this.intervalId = null;\n    this.lastHash = '';\n    this.pushIntervalStarted = false;\n  }\n\n  /**\n   * Heartland.Messages.pushMessages\n   *\n   * For legacy browsers, a mailbox (buffer) must be used to ensure all messages\n   * are sent between parent and child windows. When ready, this function builds\n   * the final message, encodes it, sends it, and resets the mailbox to `[]`.\n   *\n   * @param {Heartland.HPS} hps\n   * @returns {function}\n   */\n  pushMessages(hps: HPS): () => void {\n    return function () {\n      var data: Array<any> = [];\n      var messageArr: Array<any> = [];\n      var message = '';\n      var i = 0, length = 0;\n      var targetUrl = '', url = '';\n      var current: any;\n      var targetNode: Window;\n      var re = /^#?\\d+&/;\n\n      length = hps.mailbox.length;\n      if (!length) {\n        return;\n      }\n\n      for (i = 0; i < length; i++) {\n        current = hps.mailbox.shift();\n        if (!targetUrl) {\n          targetUrl = current.targetUrl;\n          targetNode = current.targetNode;\n        }\n        messageArr.push(current.message);\n      }\n\n      current = null;\n      if (re.test(window.location.hash)) {\n        current = JSON.parse(decodeURIComponent(window.location.hash.replace(re, '')));\n        data.concat(current);\n      }\n\n      if (messageArr !== []) {\n        hps.cacheBust = hps.cacheBust || 1;\n        data.push({ data: messageArr, source: { name: hps.field || 'parent' } });\n        message = JSON.stringify(data);\n        url = targetUrl.replace(/#.*$/, '') + '#' +\n          (+new Date()) + (hps.cacheBust++) + '&' +\n          encodeURIComponent(message);\n        if (targetNode.location) {\n          targetNode.location.href = url;\n        } else {\n          (<any>targetNode).src = url;\n        }\n      }\n\n      messageArr.length = 0;\n      hps.mailbox.length = 0;\n    };\n  }\n\n  /**\n   * Heartland.Messages.post\n   *\n   * When present, wraps the built-in `window.postMessage`. When not present,\n   * pushes the message onto the mailbox for eventual sending, and on first use,\n   * starts the interval for `Messages.pushMessages`.\n   *\n   * @param {Object | string} message\n   * @param {string} target\n   */\n  post(message: Object | string, target: string): void {\n    var frame: any;\n    var targetNode: Window;\n    var targetUrl: string;\n\n    (<any>message).source = (<any>message).source || {};\n    (<any>message).source.name = window.name;\n\n    if (!this.hps.frames) {\n      return;\n    }\n\n    frame = (<any>this.hps.frames)[target] || (<any>this.hps)[target];\n\n    if (!frame) {\n      return;\n    }\n\n    targetUrl = (<any>this.hps.frames)[target].url;\n\n    try {\n      if (typeof frame.targetNode !== 'undefined') {\n        targetNode = frame.targetNode;\n      } else if (typeof frame.frame !== 'undefined') {\n        targetNode = frame.frame;\n      }\n    } catch (e) {\n      targetNode = frame;\n    }\n\n    if (window.postMessage) {\n      targetNode.postMessage(\n        JSON.stringify(message),\n        targetUrl\n      );\n    } else {\n      this.hps.mailbox = this.hps.mailbox || [];\n      this.hps.mailbox.push({\n        message: message,\n        targetNode: targetNode,\n        targetUrl: targetUrl\n      });\n      if (!this.pushIntervalStarted) {\n        setInterval(this.pushMessages(this.hps), 10);\n      }\n    }\n  }\n\n  /**\n   * Heartland.Messages.receive\n   *\n   * When present, wraps the built-in `window.postMesage`'s `message` or\n   * `onmessage` window events. When not present, uses a single interval to\n   * check for changes to `window.location.hash` when the other window sends a\n   * message and will decode the JSON and URI encoded hash.\n   *\n   * @param {Function} callback\n   * @param {string} sourceOrigin\n   */\n  receive(callback: Function, sourceOrigin: string): void {\n    if (window.postMessage) {\n      this.callback = function (m) {\n        callback(JSON.parse(m.data));\n      };\n      if (window.addEventListener) {\n        window.addEventListener('message', this.callback, !1);\n      } else {\n        (<any>window).attachEvent('onmessage', this.callback);\n      }\n    } else {\n      if (this.intervalId) {\n        clearInterval(this.intervalId);\n      }\n      this.intervalId = null;\n\n      if (callback) {\n        this.intervalId = setInterval(function () {\n          var hash = document.location.hash,\n            re = /^#?\\d+&/;\n          if (hash !== this.lastHash && re.test(hash)) {\n            var data = JSON.parse(decodeURIComponent(hash.replace(re, '')));\n            var i: any, j: any;\n            var m: any;\n            this.lastHash = hash;\n\n            for (i in data) {\n              m = data[i];\n              if (Object.prototype.toString.call(m.data) !== '[object Array]') {\n                callback(m);\n                continue;\n              }\n\n              for (j in m.data) {\n                callback({ data: m.data[j], source: m.source });\n              }\n            }\n          }\n        }, 100);\n      }\n    }\n    Events.trigger('receiveMessageHandlerAdded', document);\n  }\n\n  /**\n   * Heartland.Messages.removeReceiver\n   *\n   * Removes active `message` event handler function.\n   */\n  removeReceiver() {\n    if (window.addEventListener) {\n      window.removeEventListener('message', this.callback, !1);\n    } else {\n      (<any>window).detachEvent('onmessage', this.callback);\n    }\n  }\n\n  /**\n   * Heartland.Messages.dispose\n   *\n   * Removes active `message` event handler function and any\n   * active intervals.\n   */\n  dispose(): void {\n    this.removeReceiver();\n    if (this.intervalId) {\n      clearInterval(this.intervalId);\n    }\n  }\n}\n","import {HPS} from \"./HPS\";\n\n/**\n * @namespace Heartland.Styles\n */\nexport module Styles {\n  /**\n   * Heartland.Styles.Defaults\n   *\n   * Collection of helper functions for applying default styles to a child\n   * window's fields. Serves as an example of these methods' use in merchant\n   * modifications. Each function expects a `Heartland.HPS` object to be passed\n   * as an argument.\n   */\n  export var Defaults = {\n    body: function (hps: HPS) {\n      hps.setStyle('heartland-body',\n        'margin: 0;' +\n        'font-family: Arial, \\'Helvetica Neue\\', Helvetica, sans-serif;' +\n        'color: #666;'\n      );\n    },\n    cvv: function (hps: HPS) {\n      hps.appendStyle('heartland-cvv', 'width: 110px;');\n    },\n    cvvContainer: function (hps: HPS) {\n      hps.setStyle('heartland-cvv-container',\n        'width: 110px;' +\n        'display: inline-block;' +\n        'float: left;'\n      );\n    },\n    fieldset: function (hps: HPS) {\n      hps.setStyle('heartland-expiration-date-container',\n        'border: 0;' +\n        'margin: 0 25px 0px 1px;' +\n        'padding: 0;' +\n        'width: 173px;' +\n        'display: inline-block;' +\n        'float:  left;'\n      );\n    },\n    inputsAndSelects: function (hps: HPS) {\n      var ids = [\n        'heartland-card-number',\n        'heartland-expiration-month',\n        'heartland-expiration-year',\n        'heartland-cvv'\n      ];\n      var i = 0, length = ids.length;\n      for (i; i < length; i++) {\n        hps.setStyle(ids[i],\n          'width: 309px;' +\n          'padding: 5px;' +\n          'font-size: 14px;' +\n          'margin: 3px 0px 15px 0px;' +\n          'border: 1px #ccc solid;' +\n          /* IE10 Consumer Preview */\n          'background-image: -ms-linear-gradient(bottom, #F7F7F7 0%, #EFEFEF 100%);' +\n          /* Mozilla Firefox */\n          'background-image: -moz-linear-gradient(bottom, #F7F7F7 0%, #EFEFEF 100%);' +\n          /* Opera */\n          'background-image: -o-linear-gradient(bottom, #F7F7F7 0%, #EFEFEF 100%);' +\n          /* Webkit (Safari/Chrome 10) */\n          'background-image: -webkit-gradient(linear, left bottom, left top, color-stop(0, #F7F7F7), color-stop(1, #EFEFEF));' +\n          /* Webkit (Chrome 11+) */\n          'background-image: -webkit-linear-gradient(bottom, #F7F7F7 0%, #EFEFEF 100%);' +\n          /* W3C Markup, IE10 Release Preview */\n          'background-image: linear-gradient(to top, #F7F7F7 0%, #EFEFEF 100%);'\n        );\n      }\n    },\n    labelsAndLegend: function (hps: HPS) {\n      var ids = [\n        'heartland-card-number-label',\n        'heartland-expiration-date-legend',\n        'heartland-expiration-month-label',\n        'heartland-expiration-year-label',\n        'heartland-cvv-label'\n      ];\n      var i = 0, length = ids.length;\n      for (i; i < length; i++) {\n        hps.setStyle(ids[i],\n          'font-size: 13px;' +\n          'text-transform: uppercase;' +\n          'font-weight: bold;' +\n          'display: block;' +\n          'width: 100%;' +\n          'clear: both;'\n        );\n      }\n    },\n    selectLabels: function (hps: HPS) {\n      var ids = ['heartland-expiration-month-label', 'heartland-expiration-year-label'];\n      var i = 0, length = ids.length;\n      for (i; i < length; i++) {\n        hps.setStyle(ids[i],\n          'position:absolute;' +\n          'width:1px;' +\n          'height:1px;' +\n          'padding:0;' +\n          'margin:-1px;' +\n          'overflow:hidden;' +\n          'clip:rect(0,0,0,0);' +\n          'border:0;'\n        );\n      }\n    },\n    selects: function (hps: HPS) {\n      var ids = ['heartland-expiration-month', 'heartland-expiration-year'];\n      var i = 0, length = ids.length;\n      for (i; i < length; i++) {\n        hps.appendStyle(ids[i],\n          'border: 0;' +\n          'outline: 1px solid #ccc;' +\n          'height: 28px;' +\n          'width: 80px;' +\n          '-webkit-appearance: none;' +\n          '-moz-appearance: none;' +\n          '-webkit-border-radius: 0px;' +\n          /* tslint:disable:max-line-length */\n          'background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDE0IDc5LjE1Njc5NywgMjAxNC8wOC8yMC0wOTo1MzowMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QzA5MTZFN0RFMDY2MTFFNEIyODZFMURFRTA3REUxMjciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QzA5MTZFN0VFMDY2MTFFNEIyODZFMURFRTA3REUxMjciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpDMDkxNkU3QkUwNjYxMUU0QjI4NkUxREVFMDdERTEyNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpDMDkxNkU3Q0UwNjYxMUU0QjI4NkUxREVFMDdERTEyNyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PvMrdUAAAABiSURBVHjaYkxLS3vNwMAgwoAfvGUCEjkMhEE285kzZ65u2bLlJ5DjgkNRxUwgYPz//z+Yl56ePhNIpaEpAqnJADGYkASzgHgnEn8HyEoYB24i1FReILUPynUEmvYFJgcQYACYah+uDhpKGAAAAABJRU5ErkJggg==);' +\n          /* tslint:enable:max-line-length */\n          'background-position: 65px 12px;' +\n          'background-repeat: no-repeat;' +\n          'background-color:  #F7F7F7;' +\n          'float: left;' +\n          'margin-right: 6px'\n        );\n      }\n    }\n  };\n}\n","import {defaults} from \"./vars/defaults\";\nimport {fields} from \"./vars/fields\";\nimport {urls} from \"./vars/urls\";\nimport {DOM} from \"./DOM\";\nimport {Events} from \"./Events\";\nimport {HPS} from \"./HPS\";\nimport {Messages} from \"./Messages\";\nimport {Styles} from \"./Styles\";\n\n/**\n * @namespace Heartland.Frames\n */\nexport class Frames {\n  /**\n   * Heartland.Frames.configureIframe\n   *\n   * Prepares the pages iFrames for communication with the parent window.\n   *\n   * @param {Heartland.HPS} hps\n   * @listens click\n   * @listens message\n   */\n  public static configureIframe(hps: HPS) {\n    var frame: any;\n    var options = hps.options;\n    var target: HTMLElement;\n    var useDefaultStyles = true;\n    hps.Messages = hps.Messages || new Messages(hps);\n\n    if (options.env === 'cert') {\n      hps.iframe_url = urls.iframeCERT;\n    } else {\n      hps.iframe_url = urls.iframePROD;\n    }\n\n    if (options.fields !== defaults.fields) {\n      Frames.makeFieldsAndLink(hps);\n    }\n\n    if (options.fields === defaults.fields && options.iframeTarget) {\n      target = document.getElementById(options.iframeTarget);\n      if (options.targetType === 'myframe') {\n        frame = target;\n        hps.iframe_url = frame.src;\n      } else {\n        frame = DOM.makeFrame('heartland-frame-securesubmit');\n        target.appendChild(frame);\n      }\n\n      hps.iframe_url = hps.iframe_url + '#' + encodeURIComponent(document.location.href.split('#')[0]);\n      frame.src = hps.iframe_url;\n\n      hps.frames.child = {\n        frame: window.postMessage ? frame.contentWindow : frame,\n        name: 'child',\n        url: hps.iframe_url\n      };\n    }\n\n    if (options.useDefaultStyles === false) {\n      useDefaultStyles = false;\n    }\n\n    if (options.buttonTarget) {\n      hps.clickHandler = function (e) {\n        e.preventDefault();\n        hps.Messages.post(\n          {\n            accumulateData: !!hps.frames.cardNumber,\n            action: 'tokenize',\n            message: options.publicKey\n          },\n          hps.frames.cardNumber ? 'cardNumber' : 'child'\n        );\n        return false;\n      };\n      Events.addHandler(options.buttonTarget, 'click', hps.clickHandler);\n    }\n\n    hps.Messages.receive(function (data: Object) {\n      var fieldFrame: any;\n\n      try {\n        fieldFrame = (<any>hps.frames)[data.source.name === 'heartland-frame-securesubmit' ? 'parent' : data.source.name];\n      } catch (e) { return; }\n\n      switch (data.action) {\n        case 'requestTokenize':\n          hps.Messages.post(\n            {\n              accumulateData: !!hps.frames.cardNumber,\n              action: 'tokenize',\n              message: options.publicKey\n            },\n            hps.frames.cardNumber ? 'cardNumber' : 'child'\n          );\n          break;\n        case 'onTokenSuccess':\n          options.onTokenSuccess(data.response);\n          break;\n        case 'onTokenError':\n          options.onTokenError(data.response);\n          break;\n        case 'resize':\n          if (fieldFrame) {\n            hps.resizeIFrame(fieldFrame.frame, data.height);\n          } else {\n            hps.resizeIFrame(frame, data.height);\n          }\n\n          break;\n        case 'receiveMessageHandlerAdded':\n          if (!options.fields && useDefaultStyles) {\n            Styles.Defaults.body(hps);\n            Styles.Defaults.labelsAndLegend(hps);\n            Styles.Defaults.inputsAndSelects(hps);\n            Styles.Defaults.fieldset(hps);\n            Styles.Defaults.selects(hps);\n            Styles.Defaults.selectLabels(hps);\n            Styles.Defaults.cvvContainer(hps);\n            Styles.Defaults.cvv(hps);\n          }\n\n          if (fieldFrame && fieldFrame.options.placeholder) {\n            hps.Messages.post(\n              {\n                action: 'setPlaceholder',\n                id: 'heartland-field',\n                text: fieldFrame.options.placeholder\n              },\n              fieldFrame.name\n            );\n          }\n\n          if (options.style) {\n            var css = options.styleString\n              || (options.styleString = DOM.json2css(options.style));\n            hps.Messages.post(\n              {\n                action: 'addStylesheet',\n                data: css\n              },\n              fieldFrame.name\n            );\n          }\n\n          Events.trigger('securesubmitIframeReady', document);\n          break;\n        case 'accumulateData':\n          var i: string;\n          var field: any;\n\n          for (i in hps.frames) {\n            if ('submit' === i || 'cardNumber' === i) {\n              continue;\n            }\n            field = (<any>hps.frames)[i];\n            hps.Messages.post(\n              {\n                action: 'getFieldData',\n                id: 'heartland-field'\n              },\n              field.name\n            );\n          }\n          break;\n        case 'passData':\n          var cardNumberFieldFrame = hps.frames.cardNumber;\n          if (!cardNumberFieldFrame) {\n            break;\n          }\n\n          hps.Messages.post(\n            {\n              action: 'setFieldData',\n              id: fieldFrame.name,\n              value: data.value\n            },\n            cardNumberFieldFrame.name\n          );\n          break;\n        case 'fieldEvent':\n          if (!options.onEvent) {\n            break;\n          }\n          options.onEvent(data.event);\n          break;\n        case 'error':\n          if (!options.onError) {\n            break;\n          }\n          options.onError(data);\n          break;\n      }\n    }, '*');\n\n\n    // monitorFieldEvents(hps, )\n  }\n\n  /**\n   * Heartland.Frames.makeFieldsAndLink\n   *\n   * Creates a set of single field iFrames and stores a reference to\n   * them in the parent window's state.\n   *\n   * @param {Heartland.HPS} hps\n   */\n  public static makeFieldsAndLink(hps: HPS) {\n    var options = hps.options;\n    var fieldsLength = fields.length;\n    var baseUrl = hps.iframe_url.replace('index.html', '');\n\n    for (var i = 0; i < fieldsLength; i++) {\n      var field = fields[i];\n      var fieldOptions = options.fields[field];\n\n      if (!fieldOptions) { return; }\n\n      var frame = DOM.makeFrame(field);\n      var url = baseUrl;\n      if (field === 'submit') {\n        url = url + 'button.html';\n      } else {\n        url = url + 'field.html';\n      }\n      url = url + '#' + field + ':' + encodeURIComponent(document.location.href.split('#')[0]);\n      frame.src = url;\n\n      document\n        .getElementById(fieldOptions.target)\n        .appendChild(frame);\n\n      (<any>hps.frames)[field] = {\n        frame: frame,\n        name: field,\n        options: fieldOptions,\n        target: fieldOptions.target,\n        targetNode: window.postMessage ? frame.contentWindow : frame,\n        url: url\n      };\n    }\n  }\n\n  /**\n   * Heartland.Frames.monitorFieldEvents\n   *\n   * @param {Heartland.HPS} hps\n   * @param {string | EventTarget} target\n   */\n  public static monitorFieldEvents(hps: HPS, target: string | EventTarget) {\n    var events = ['click', 'blur', 'focus', 'change', 'keypress', 'keydown', 'keyup'];\n    var i = 0, length = events.length;\n    var event: string;\n\n    for (i; i < length; i++) {\n      event = events[i];\n      Events.addHandler(target, event, function (e: Event) {\n        var field = document.getElementById('heartland-field');\n        var classes: string[] = [];\n        var data: any = {};\n\n        if (field.className !== '') {\n          classes = field.className.split(' ');\n        }\n\n        if ((<any>e).keyCode) {\n          data.keyCode = (<any>e).keyCode;\n        }\n\n        hps.Messages.post(\n          {\n            action: 'fieldEvent',\n            event: {\n              classes: classes,\n              data: data,\n              source: window.name,\n              type: e.type\n            }\n          },\n          'parent'\n        );\n      });\n    }\n  }\n}\n","import {defaults} from \"./vars/defaults\";\n\nimport {Ajax} from \"./Ajax\";\nimport {Card} from \"./Card\";\nimport {DOM} from \"./DOM\";\nimport {Events} from \"./Events\";\nimport {Frames} from \"./Frames\";\nimport {Messages} from \"./Messages\";\nimport {Util} from \"./Util\";\n\nimport {Options} from \"./types/Options\";\n\ninterface Frame {\n  frame?: Window;\n  name?: string;\n  options?: any;\n  target?: string;\n  targetNode?: EventTarget;\n  url?: string;\n}\n\ninterface FrameCollection {\n  cardNumber?: Frame;\n  cardExpiration?: Frame;\n  cardCvv?: Frame;\n  submit?: Frame;\n  child?: Frame;\n  parent?: Frame;\n}\n\n/**\n * Heartland.HPS\n *\n * Initializes options and adds the default form handler if a `formId` is\n * passed as an option. This expects the default fields (see `getFields`) to\n * be present as children of `formId`.\n */\nexport class HPS {\n  options: Options;\n  frames: FrameCollection;\n  iframe_url: string;\n  Messages: Messages;\n  mailbox: any; // [];\n  cacheBust: number;\n  parent: Window;\n  field: string;\n  clickHandler: (e: Event) => void;\n  loadHandler: () => void;\n  receiveMessageHandlerAddedHandler: () => void;\n\n  /**\n   * Heartland.HPS (constructor)\n   *\n   * @constructor\n   * @param {Heartland.Options} options [optional]\n   * @returns {Heartland.HPS}\n   */\n  constructor(options?: Options) {\n    if (!options && window.parent) {\n      return;\n    }\n\n    this.options = Util.applyOptions(defaults, options);\n    this.options = Util.getUrlByEnv(this.options);\n\n    if (this.options.formId.length > 0) {\n      Util.addFormHandler(this.options);\n    }\n\n    this.frames = {};\n    if (this.options.type === 'iframe') {\n      this.iframe_url = '';\n\n      this.Messages = new Messages(this);\n      this.mailbox = [];\n      this.cacheBust = 1;\n      Frames.configureIframe(this);\n    }\n\n    return this;\n  }\n\n  /**\n   * Heartland.HPS.tokenize\n   *\n   * Tokenizes card data. Used in manual integrations where the merchant's\n   * credit card fields cannot/do not match the names expected in the default\n   * form handler (see `getFields`).\n   *\n   * @param {Heartland.Options} options [optional]\n   */\n  tokenize(options?: Options): void {\n    options = options || {};\n    if (options) {\n      this.options = Util.applyOptions(this.options, options);\n      this.options = Util.getUrlByEnv(this.options);\n    }\n    if (this.options.type === 'iframe') {\n      this.Messages.post(\n        {\n          action: 'tokenize',\n          message: this.options.publicKey\n        },\n        'child'\n      );\n      return;\n    }\n    Ajax.call(this.options.type, this.options);\n  };\n\n  /**\n   * Heartland.HPS.configureInternalIframe\n   *\n   * Sets up a child iframe window to prepare it for communication with the\n   * parent and for tokenization.\n   *\n   * @param {Heartland.Options} options\n   */\n  configureInternalIframe(options: Options): void {\n    this.Messages = new Messages(this);\n    this.parent = window.parent;\n    this.frames = this.frames || {};\n    this.frames.parent = {\n      frame: window.parent,\n      name: 'parent',\n      url: decodeURIComponent(document.location.hash.replace(/^#/, ''))\n    };\n\n    this.loadHandler = (function (hps: HPS) {\n      return function () {\n        DOM.resizeFrame(hps);\n      };\n    } (this));\n\n    this.receiveMessageHandlerAddedHandler = (function (hps: HPS) {\n      return function () {\n        hps.Messages.post({ action: 'receiveMessageHandlerAdded' }, 'parent');\n      };\n    } (this));\n\n    Events.addHandler(window, 'load', this.loadHandler);\n    Events.addHandler(document, 'receiveMessageHandlerAdded', this.receiveMessageHandlerAddedHandler);\n\n    this.Messages.receive(Events.frameHandleWith(this), '*');\n  };\n\n  /**\n   * Heartland.HPS.configureButtonFieldIframe\n   *\n   * Same as `Heartland.HPS.configureFieldIframe` excet the added click event\n   * handler for the button.\n   *\n   * @param {Heartland.Options} options\n   */\n  configureButtonFieldIframe(options: Options): void {\n    this.configureFieldIframe(options);\n    Events.addHandler('heartland-field', 'click', (function (hps: HPS) {\n      return function (e: Event) {\n        e.preventDefault ? e.preventDefault() : (e.returnValue = false);\n        hps.Messages.post({ action: 'requestTokenize' }, 'parent');\n      };\n    } (this)));\n  }\n\n  /**\n   * Heartland.HPS.configureFieldIframe\n   *\n   * Sets up a child iframe window to prepare it for communication with the\n   * parent and for tokenization.\n   *\n   * @param {Heartland.Options} options\n   */\n  configureFieldIframe(options: Options): void {\n    var hash = document.location.hash.replace(/^#/, '');\n    var split = hash.split(':');\n    this.Messages = new Messages(this);\n    this.field = split.shift();\n    this.parent = window.parent;\n    this.frames = this.frames || {};\n    this.frames.parent = {\n      frame: window.parent,\n      name: 'parent',\n      url: decodeURIComponent(split.join(':').replace(/^:/, ''))\n    };\n\n    window.onerror = (function (hps: HPS) {\n      return function (errorMsg: string, url: string, lineNumber: number, column: number, errorObj: any) {\n        hps.Messages.post({\n          action: 'error',\n          data: {\n            column: column,\n            errorMsg: errorMsg,\n            lineNumber: lineNumber,\n            url: url\n          }\n        }, 'parent');\n        return true;\n      };\n    } (this));\n\n    this.loadHandler = (function (hps: HPS) {\n      return function () {\n        DOM.resizeFrame(hps);\n        DOM.configureField(hps);\n        var method = 'attach' + window.name.replace('card', '') + 'Events';\n        if ((<any>Card)[method]) {\n          (<any>Card)[method]('#heartland-field');\n        }\n      };\n    } (this));\n\n    this.receiveMessageHandlerAddedHandler = (function (hps: HPS) {\n      return function () {\n        hps.Messages.post({ action: 'receiveMessageHandlerAdded' }, 'parent');\n      };\n    } (this));\n\n    Events.addHandler(window, 'load', this.loadHandler);\n    Events.addHandler(document, 'receiveMessageHandlerAdded', this.receiveMessageHandlerAddedHandler);\n    Frames.monitorFieldEvents(this, 'heartland-field');\n\n    this.Messages.receive(Events.frameHandleWith(this), '*');\n  };\n\n  /**\n   * Heartland.HPS.resizeIFrame\n   *\n   * Called automatically when the child iframe window alerts the parent to\n   * resize.\n   *\n   * @param {HTMLIFrameElement} frame\n   * @param {string} height\n   */\n  resizeIFrame(frame: HTMLIFrameElement, height: string): void {\n    if (!frame) { return; }\n    frame.style.height = (parseInt(height, 10)) + 'px';\n  };\n\n  /**\n   * Heartland.HPS.setText\n   *\n   * Public API for setting an element's inner text.\n   *\n   * @param {string} elementid\n   * @param {string} elementtext\n   */\n  setText(elementid: string, elementtext: string): void {\n    this.Messages.post({ action: 'setText', id: elementid, text: elementtext }, 'child');\n  };\n\n  /**\n   * Heartland.HPS.setStyle\n   *\n   * Public API for setting an element's style.\n   *\n   * @param {string} elementid\n   * @param {string} elementstyle\n   */\n  setStyle(elementid: string, elementstyle: string): void {\n    this.Messages.post({ action: 'setStyle', id: elementid, style: elementstyle }, 'child');\n  };\n\n  /**\n   * Heartland.HPS.appendStyle\n   *\n   * Public API for appending to an element's style.\n   *\n   * @param {string} elementid\n   * @param {string} elementstyle\n   */\n  appendStyle(elementid: string, elementstyle: string): void {\n    this.Messages.post({ action: 'appendStyle', id: elementid, style: elementstyle }, 'child');\n  };\n\n  /**\n   * Heartland.HPS.setFocus\n   *\n   * Public API for appending to an element's style.\n   *\n   * @param {string} elementid\n   */\n  setFocus(elementid: string): void {\n    this.Messages.post({ action: 'setFocus' }, elementid);\n  };\n\n  /**\n   * Heartland.HPS.dispose\n   *\n   * Removes all iframes and event listeners from the DOM.\n   */\n  dispose(): void {\n    this.Messages.dispose();\n    this.Messages = null;\n    if (this.frames.cardNumber && this.frames.cardNumber.targetNode) {\n      (<any>this.frames.cardNumber.frame).remove();\n    }\n    if (this.frames.cardExpiration && this.frames.cardExpiration.frame) {\n      (<any>this.frames.cardExpiration.frame).remove();\n    }\n    if (this.frames.cardCvv && this.frames.cardCvv.frame) {\n      (<any>this.frames.cardCvv.frame).remove();\n    }\n    if (this.frames.child && this.frames.child.frame) {\n      (<any>this.frames.child.frame).remove();\n    }\n    if (this.clickHandler) {\n      Events.removeHandler(\n        this.options.buttonTarget,\n        'click',\n        this.clickHandler\n      );\n    }\n    if (this.loadHandler) {\n      Events.removeHandler(\n        window,\n        'load',\n        this.loadHandler\n      );\n    }\n    if (this.receiveMessageHandlerAddedHandler) {\n      Events.removeHandler(\n        document,\n        'receiveMessageHandlerAdded',\n        this.receiveMessageHandlerAddedHandler\n      );\n    }\n  };\n}\n","import {CardNumber} from \"./CardNumber\";\nimport {Cvv} from \"./Cvv\";\nimport {Expiration} from \"./Expiration\";\n\nexport default {\n    CardNumber: CardNumber,\n    Cvv: Cvv,\n    Expiration: Expiration\n}\n","import {Ajax} from \"./Ajax\";\nimport {Card} from \"./Card\";\nimport {DOM} from \"./DOM\";\nimport {Events} from \"./Events\";\nimport Formatter from \"./Formatter\";\nimport {Frames} from \"./Frames\";\nimport {HPS} from \"./HPS\";\nimport {Messages} from \"./Messages\";\nimport {Styles} from \"./Styles\";\nimport {Util} from \"./Util\";\nimport Validator from \"./Validator\";\n\nexport default {\n    Ajax: Ajax,\n    Card: Card,\n    DOM: DOM,\n    Events: Events,\n    Formatter: Formatter,\n    Frames: Frames,\n    HPS: HPS,\n    Messages: Messages,\n    Styles: Styles,\n    Util: Util,\n    Validator: Validator\n}\n"],"names":["ExpirationFormatter","CardNumberFormatter","CardNumberValidator","CvvValidator","ExpirationValidator","CardNumber","Expiration"],"mappings":"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"}