{"version":3,"file":null,"sources":["../src/HPS.ts"],"sourcesContent":["/// <reference path=\"vars/defaults.ts\" />\n/// <reference path=\"vendor/json2.ts\" />\n\n/// <reference path=\"Ajax.ts\" />\n/// <reference path=\"DOM.ts\" />\n/// <reference path=\"Events.ts\" />\n/// <reference path=\"Frames.ts\" />\n/// <reference path=\"Messages.ts\" />\n/// <reference path=\"Styles.ts\" />\n/// <reference path=\"Util.ts\" />\n\nmodule Heartland {\n  interface Frame {\n    frame?: Window;\n    name?: string;\n    options?: any;\n    target?: string;\n    targetNode?: EventTarget;\n    url?: string;\n  }\n  interface Frames {\n    cardNumber?: Frame;\n    cardExpiration?: Frame;\n    cardCvv?: Frame;\n    submit?: Frame;\n    child?: Frame;\n    parent?: Frame;\n  }\n  /**\n   * Heartland.HPS\n   *\n   * Initializes options and adds the default form handler if a `formId` is\n   * passed as an option. This expects the default fields (see `getFields`) to\n   * be present as children of `formId`.\n   */\n  export class HPS {\n    options: Options;\n    frames: Frames;\n    iframe_url: string;\n    Messages: Messages;\n    mailbox: any; // [];\n    cacheBust: number;\n    parent: Window;\n    field: string;\n    clickHandler: (e: Event) => void;\n    loadHandler: () => void;\n    receiveMessageHandlerAddedHandler: () => void;\n\n    /**\n     * Heartland.HPS (constructor)\n     *\n     * @constructor\n     * @param {Heartland.Options} options [optional]\n     * @returns {Heartland.HPS}\n     */\n    constructor(options?: Options) {\n      if (!options && window.parent) {\n        return;\n      }\n\n      this.options = Heartland.Util.applyOptions(defaults, options);\n      this.options = Heartland.Util.getUrlByEnv(this.options);\n\n      if (this.options.formId.length > 0) {\n        Heartland.Util.addFormHandler(this.options);\n      }\n\n      this.frames = {};\n      if (this.options.type === 'iframe') {\n        this.iframe_url = '';\n\n        this.Messages = new Heartland.Messages(this);\n        this.mailbox = [];\n        this.cacheBust = 1;\n        Heartland.Frames.configureIframe(this);\n      }\n\n      return this;\n    }\n\n    /**\n     * Heartland.HPS.tokenize\n     *\n     * Tokenizes card data. Used in manual integrations where the merchant's\n     * credit card fields cannot/do not match the names expected in the default\n     * form handler (see `getFields`).\n     *\n     * @param {Heartland.Options} options [optional]\n     */\n    tokenize(options?: Options): void {\n      options = options || {};\n      if (options) {\n        this.options = Heartland.Util.applyOptions(this.options, options);\n        this.options = Heartland.Util.getUrlByEnv(this.options);\n      }\n      if (this.options.type === 'iframe') {\n        this.Messages.post(\n          {\n            action: 'tokenize',\n            message: this.options.publicKey\n          },\n          'child'\n        );\n        return;\n      }\n      Heartland.Ajax.call(this.options.type, this.options);\n    };\n\n    /**\n     * Heartland.HPS.configureInternalIframe\n     *\n     * Sets up a child iframe window to prepare it for communication with the\n     * parent and for tokenization.\n     *\n     * @param {Heartland.Options} options\n     */\n    configureInternalIframe(options: Options): void {\n      this.Messages = new Heartland.Messages(this);\n      this.parent = window.parent;\n      this.frames = this.frames || {};\n      this.frames.parent = {\n        frame: window.parent,\n        name: 'parent',\n        url: decodeURIComponent(document.location.hash.replace(/^#/, ''))\n      };\n\n      this.loadHandler = (function (hps: HPS) {\n        return function () {\n          Heartland.DOM.resizeFrame(hps);\n        };\n      }(this));\n\n      this.receiveMessageHandlerAddedHandler = (function (hps: HPS) {\n        return function () {\n          hps.Messages.post({action: 'receiveMessageHandlerAdded'}, 'parent');\n        };\n      }(this));\n\n      Heartland.Events.addHandler(window, 'load', this.loadHandler);\n      Heartland.Events.addHandler(document, 'receiveMessageHandlerAdded', this.receiveMessageHandlerAddedHandler);\n\n      this.Messages.receive(Heartland.Events.frameHandleWith(this), '*');\n    };\n\n    /**\n     * Heartland.HPS.configureButtonFieldIframe\n     *\n     * Same as `Heartland.HPS.configureFieldIframe` excet the added click event\n     * handler for the button.\n     *\n     * @param {Heartland.Options} options\n     */\n    configureButtonFieldIframe(options: Options): void {\n      this.configureFieldIframe(options);\n      Heartland.Events.addHandler('heartland-field', 'click', (function (hps: HPS) {\n        return function (e: Event) {\n          e.preventDefault ? e.preventDefault() : (e.returnValue = false);\n          hps.Messages.post({action: 'requestTokenize'}, 'parent');\n        };\n      }(this)));\n    }\n\n    /**\n     * Heartland.HPS.configureFieldIframe\n     *\n     * Sets up a child iframe window to prepare it for communication with the\n     * parent and for tokenization.\n     *\n     * @param {Heartland.Options} options\n     */\n    configureFieldIframe(options: Options): void {\n      var hash = document.location.hash.replace(/^#/, '');\n      var split = hash.split(':');\n      this.Messages = new Heartland.Messages(this);\n      this.field = split.shift();\n      this.parent = window.parent;\n      this.frames = this.frames || {};\n      this.frames.parent = {\n        frame: window.parent,\n        name: 'parent',\n        url: decodeURIComponent(split.join(':').replace(/^:/, ''))\n      };\n\n      window.onerror = (function (hps: HPS) {\n        return function (errorMsg: string, url: string, lineNumber: number, column: number, errorObj: any) {\n          hps.Messages.post({\n            action: 'error',\n            data: {\n              column: column,\n              errorMsg: errorMsg,\n              lineNumber: lineNumber,\n              url: url\n            }\n          }, 'parent');\n          return true;\n        };\n      }(this));\n\n      this.loadHandler = (function (hps: HPS) {\n        return function () {\n          Heartland.DOM.resizeFrame(hps);\n          Heartland.DOM.configureField(hps);\n          var method = 'attach' + window.name.replace('card', '') + 'Events';\n          if ((<any>Heartland.Card)[method]) {\n            (<any>Heartland.Card)[method]('#heartland-field');\n          }\n        };\n      }(this));\n\n      this.receiveMessageHandlerAddedHandler = (function (hps: HPS) {\n        return function () {\n          hps.Messages.post({action: 'receiveMessageHandlerAdded'}, 'parent');\n        };\n      }(this));\n\n      Heartland.Events.addHandler(window, 'load', this.loadHandler);\n      Heartland.Events.addHandler(document, 'receiveMessageHandlerAdded', this.receiveMessageHandlerAddedHandler);\n      Heartland.Frames.monitorFieldEvents(this, 'heartland-field');\n\n      this.Messages.receive(Heartland.Events.frameHandleWith(this), '*');\n    };\n\n    /**\n     * Heartland.HPS.resizeIFrame\n     *\n     * Called automatically when the child iframe window alerts the parent to\n     * resize.\n     *\n     * @param {HTMLIFrameElement} frame\n     * @param {string} height\n     */\n    resizeIFrame(frame: HTMLIFrameElement, height: string): void {\n      if (!frame) { return; }\n      frame.style.height = (parseInt(height, 10)) + 'px';\n    };\n\n    /**\n     * Heartland.HPS.setText\n     *\n     * Public API for setting an element's inner text.\n     *\n     * @param {string} elementid\n     * @param {string} elementtext\n     */\n    setText(elementid: string, elementtext: string): void {\n      this.Messages.post({action: 'setText', id: elementid, text: elementtext}, 'child');\n    };\n\n    /**\n     * Heartland.HPS.setStyle\n     *\n     * Public API for setting an element's style.\n     *\n     * @param {string} elementid\n     * @param {string} elementstyle\n     */\n    setStyle(elementid: string, elementstyle: string): void {\n      this.Messages.post({action: 'setStyle', id: elementid, style: elementstyle}, 'child');\n    };\n\n    /**\n     * Heartland.HPS.appendStyle\n     *\n     * Public API for appending to an element's style.\n     *\n     * @param {string} elementid\n     * @param {string} elementstyle\n     */\n    appendStyle(elementid: string, elementstyle: string): void {\n      this.Messages.post({action: 'appendStyle', id: elementid, style: elementstyle}, 'child');\n    };\n\n    /**\n     * Heartland.HPS.setFocus\n     *\n     * Public API for appending to an element's style.\n     *\n     * @param {string} elementid\n     */\n    setFocus(elementid: string): void {\n      this.Messages.post({action: 'setFocus'}, elementid);\n    };\n\n    /**\n     * Heartland.HPS.dispose\n     *\n     * Removes all iframes and event listeners from the DOM.\n     */\n    dispose(): void {\n      this.Messages.dispose();\n      this.Messages = null;\n      if (this.frames.cardNumber && this.frames.cardNumber.targetNode) {\n        (<any>this.frames.cardNumber.frame).remove();\n      }\n      if (this.frames.cardExpiration && this.frames.cardExpiration.frame) {\n        (<any>this.frames.cardExpiration.frame).remove();\n      }\n      if (this.frames.cardCvv && this.frames.cardCvv.frame) {\n        (<any>this.frames.cardCvv.frame).remove();\n      }\n      if (this.frames.child && this.frames.child.frame) {\n        (<any>this.frames.child.frame).remove();\n      }\n      if (this.clickHandler) {\n        Heartland.Events.removeHandler(\n          this.options.buttonTarget,\n          'click',\n          this.clickHandler\n        );\n      }\n      if (this.loadHandler) {\n        Heartland.Events.removeHandler(\n          window,\n          'load',\n          this.loadHandler\n        );\n      }\n      if (this.receiveMessageHandlerAddedHandler) {\n        Heartland.Events.removeHandler(\n          document,\n          'receiveMessageHandlerAdded',\n          this.receiveMessageHandlerAddedHandler\n        );\n      }\n    };\n  }\n}\n"],"names":[],"mappings":"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"}